@use "../../utils/themes" as themes;
@use "../../utils/tokens" as tokens;

// ===================================
// ERPS TOGGLES COMPONENT
// ===================================
// Modern, theme-aware toggle switches for the Eventide RP System
// Uses tertiary theme colors for checked state tracks

// ===================================
// CONFIGURATION VARIABLES
// ===================================

// Toggle sizing
$toggle-width: 3rem;
$toggle-height: 1.5rem;
$toggle-thumb-size: 1.2rem;
$toggle-border-radius: 0.75rem;
$toggle-thumb-border-radius: 50%;

// Spacing and positioning
$toggle-thumb-offset: 0.15rem;
$toggle-thumb-travel: calc($toggle-width - $toggle-thumb-size - ($toggle-thumb-offset * 2));
$toggle-border-width: 2px;

// Typography
$toggle-label-font-size: 0.9rem;
$toggle-label-gap: 0.5rem;

// Transitions
$toggle-transition-duration: 0.3s;
$toggle-transition-easing: ease-in-out;

// Shadows and effects
$toggle-shadow-blur: 4px;
$toggle-glow-blur: 8px;
$toggle-thumb-shadow: 0 2px 4px;

// Opacity values
$toggle-disabled-opacity: 0.6;
$toggle-focus-opacity: 0.3;

// ===================================
// THEME-AWARE DEFAULTS FOR TOGGLES
// ===================================

:root {
  // Default theme (blue)
  --erps-toggle-primary: #4a90e2;
  --erps-toggle-secondary: #357abd;
  --erps-toggle-bright: #6bb6ff;
  --erps-toggle-glow: rgb(74 144 226 / 30%);
  --erps-toggle-text: #fff;
}

// Theme-specific defaults that activate based on sheet classes
.eventide-sheet[data-bg-theme="blue"] {
  --erps-toggle-primary: #4a90e2;
  --erps-toggle-secondary: #357abd;
  --erps-toggle-bright: #6bb6ff;
  --erps-toggle-glow: rgb(74 144 226 / 30%);
  --erps-toggle-text: #fff;
}

.eventide-sheet[data-bg-theme="black"] {
  --erps-toggle-primary: #2c2c2c;
  --erps-toggle-secondary: #1a1a1a;
  --erps-toggle-bright: #4a4a4a;
  --erps-toggle-glow: rgb(44 44 44 / 30%);
  --erps-toggle-text: #fff;
}

.eventide-sheet[data-bg-theme="green"] {
  --erps-toggle-primary: #4a9e4a;
  --erps-toggle-secondary: #357a35;
  --erps-toggle-bright: #6bb66b;
  --erps-toggle-glow: rgb(74 158 74 / 30%);
  --erps-toggle-text: #fff;
}

.eventide-sheet[data-bg-theme="light"] {
  --erps-toggle-primary: #e2e2e2;
  --erps-toggle-secondary: #c0c0c0;
  --erps-toggle-bright: #fff;
  --erps-toggle-glow: rgb(226 226 226 / 30%);
  --erps-toggle-text: #1a1a1a;
}

.eventide-sheet[data-bg-theme="gold"] {
  --erps-toggle-primary: #d4af37;
  --erps-toggle-secondary: #b8941f;
  --erps-toggle-bright: #f4d03f;
  --erps-toggle-glow: rgb(212 175 55 / 30%);
  --erps-toggle-text: #fff;
}

.eventide-sheet[data-bg-theme="purple"] {
  --erps-toggle-primary: #8e44ad;
  --erps-toggle-secondary: #7d3c98;
  --erps-toggle-bright: #a569bd;
  --erps-toggle-glow: rgb(142 68 173 / 30%);
  --erps-toggle-text: #fff;
}

// ===================================
// TOGGLE COMPONENT
// ===================================

.erps-toggles {
  // Container for toggle and label
  display: inline-flex;
  align-items: center;
  gap: $toggle-label-gap;
  cursor: pointer;
  user-select: none;
  transition: all $toggle-transition-duration $toggle-transition-easing;

  // Hidden checkbox input
  &__input {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
    pointer-events: none;

    &:focus + .erps-toggles__container .erps-toggles__track {
      box-shadow:
        $toggle-thumb-shadow themes.color(black, 30),
        0 0 $toggle-glow-blur var(--erps-toggle-bright, var(--theme-bright, var(--erps-toggle-bright)));
    }

    &:checked + .erps-toggles__container .erps-toggles__track {
      background: var(--erps-toggle-primary, var(--theme-primary, var(--erps-toggle-primary)));
      border-color: var(--erps-toggle-secondary, var(--theme-secondary, var(--erps-toggle-secondary)));
      box-shadow:
        inset 0 1px 3px themes.color(black, 20),
        0 0 $toggle-shadow-blur var(--erps-toggle-glow, var(--theme-glow, var(--erps-toggle-glow)));

      .erps-toggles__thumb {
        transform: translateY(-50%) translateX($toggle-thumb-travel);
        background: themes.color(white, 95);
        border-color: var(--erps-toggle-secondary, var(--theme-secondary, var(--erps-toggle-secondary)));
        box-shadow:
          $toggle-thumb-shadow themes.color(black, 40),
          0 0 $toggle-shadow-blur var(--erps-toggle-glow, var(--theme-glow, var(--erps-toggle-glow)));
      }
    }

    &:disabled + .erps-toggles__container .erps-toggles__track {
      opacity: $toggle-disabled-opacity;
      cursor: not-allowed;
      background: themes.color(gray, 30);
      border-color: themes.color(gray, 40);

      .erps-toggles__thumb {
        background: themes.color(gray, 60);
        border-color: themes.color(gray, 70);
        box-shadow: $toggle-thumb-shadow themes.color(black, 20);
      }
    }
  }

  // Container wrapper for track and label positioning
  &__container {
    display: flex;
    align-items: center;
    gap: $toggle-label-gap;
  }

  // Track (background of the toggle)
  &__track {
    position: relative;
    display: inline-block;
    width: $toggle-width;
    height: $toggle-height;
    background: themes.color(gray-dark, 60);
    border: $toggle-border-width solid themes.color(gray, 40);
    border-radius: $toggle-border-radius;
    transition: all $toggle-transition-duration $toggle-transition-easing;
    cursor: pointer;
    box-shadow:
      inset 0 1px 3px themes.color(black, 30),
      0 1px 2px themes.color(black, 10);
    flex-shrink: 0;

    &:hover {
      border-color: var(--erps-toggle-bright, var(--theme-bright, var(--erps-toggle-bright)));
      box-shadow:
        inset 0 1px 3px themes.color(black, 30),
        0 0 $toggle-shadow-blur var(--erps-toggle-glow, var(--theme-glow, var(--erps-toggle-glow)));
    }
  }

  // Thumb (the sliding button part)
  &__thumb {
    position: absolute;
    top: 50%;
    left: $toggle-thumb-offset;
    width: $toggle-thumb-size;
    height: $toggle-thumb-size;
    background: themes.color(white, 90);
    border: $toggle-border-width solid themes.color(gray, 50);
    border-radius: $toggle-thumb-border-radius;
    transition: all $toggle-transition-duration $toggle-transition-easing;
    cursor: pointer;
    box-shadow: $toggle-thumb-shadow themes.color(black, 30);
    transform: translateY(-50%);

    // Add a subtle inner glow
    &::before {
      content: '';
      position: absolute;
      inset: 2px;
      background: radial-gradient(circle, themes.color(white, 20) 0%, transparent 70%);
      border-radius: $toggle-thumb-border-radius;
      pointer-events: none;
    }
  }

  // Label text
  &__label {
    font-family: var(--erps-ui-font, sans-serif);
    font-size: $toggle-label-font-size;
    font-weight: 500;
    color: var(--erps-toggle-text, var(--theme-text, var(--erps-toggle-text)));
    cursor: pointer;
    transition: color $toggle-transition-duration $toggle-transition-easing;
    text-shadow: 0 1px 2px themes.color(black, 60);
  }

  // ===================================
  // MODIFIER CLASSES
  // ===================================

  // Size modifiers
  &--small {
    .erps-toggles__track {
      width: 2.5rem;
      height: 1.25rem;
      border-radius: 0.625rem;
    }

    .erps-toggles__thumb {
      width: 1rem;
      height: 1rem;

      --thumb-travel: calc(2.5rem - 1rem - (#{$toggle-thumb-offset} * 2));
    }

    .erps-toggles__input:checked + .erps-toggles__container .erps-toggles__track .erps-toggles__thumb {
      transform: translateY(-50%) translateX(var(--thumb-travel, calc(2.5rem - 1rem - #{$toggle-thumb-offset * 2})));
    }

    .erps-toggles__label {
      font-size: 0.8rem;
    }
  }

  &--large {
    .erps-toggles__track {
      width: 3.5rem;
      height: 1.75rem;
      border-radius: 0.875rem;
    }

    .erps-toggles__thumb {
      width: 1.4rem;
      height: 1.4rem;

      --thumb-travel: calc(3.5rem - 1.4rem - (#{$toggle-thumb-offset} * 2));
    }

    .erps-toggles__input:checked + .erps-toggles__container .erps-toggles__track .erps-toggles__thumb {
      transform: translateY(-50%) translateX(var(--thumb-travel, calc(3.5rem - 1.4rem - #{$toggle-thumb-offset * 2})));
    }

    .erps-toggles__label {
      font-size: 1rem;
    }
  }

  // Label position modifiers - BEM styled
  &--label-left {
    .erps-toggles__container {
      .erps-toggles__label {
        order: 1; // Label first (left)
      }

      .erps-toggles__track {
        order: 2; // Track second (right)
      }
    }
  }

  &--label-right {
    .erps-toggles__container {
      .erps-toggles__track {
        order: 1; // Track first (left)
      }

      .erps-toggles__label {
        order: 2; // Label second (right)
      }
    }
  }

  &--label-above {
    .erps-toggles__container {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.25rem;

      .erps-toggles__label {
        order: 1; // Label first (above)
      }

      .erps-toggles__track {
        order: 2; // Track second (below)
      }
    }
  }

  &--label-below {
    .erps-toggles__container {
      flex-direction: column;
      align-items: flex-start;
      gap: 0.25rem;

      .erps-toggles__track {
        order: 1; // Track first (above)
      }

      .erps-toggles__label {
        order: 2; // Label second (below)
      }
    }
  }

  // No label (toggle only)
  &--no-label {
    .erps-toggles__label {
      display: none;
    }
  }

  // State modifiers
  &--disabled {
    opacity: $toggle-disabled-opacity;
    cursor: not-allowed;
    pointer-events: none;
  }

  // Color theme overrides (for specific use cases)
  &--success {
    .erps-toggles__input:checked + .erps-toggles__container .erps-toggles__track {
      background: themes.color(green, 70);
      border-color: themes.color(green, 80);
      box-shadow:
        inset 0 1px 3px themes.color(black, 20),
        0 0 $toggle-shadow-blur themes.color(green, 40);

      .erps-toggles__thumb {
        transform: translateY(-50%) translateX($toggle-thumb-travel);
        border-color: themes.color(green, 80);
        box-shadow:
          $toggle-thumb-shadow themes.color(black, 40),
          0 0 $toggle-shadow-blur themes.color(green, 50);
      }
    }
  }

  &--danger {
    .erps-toggles__input:checked + .erps-toggles__container .erps-toggles__track {
      background: themes.color(red, 70);
      border-color: themes.color(red, 80);
      box-shadow:
        inset 0 1px 3px themes.color(black, 20),
        0 0 $toggle-shadow-blur themes.color(red, 40);

      .erps-toggles__thumb {
        transform: translateY(-50%) translateX($toggle-thumb-travel);
        border-color: themes.color(red, 80);
        box-shadow:
          $toggle-thumb-shadow themes.color(black, 40),
          0 0 $toggle-shadow-blur themes.color(red, 50);
      }
    }
  }

  &--warning {
    .erps-toggles__input:checked + .erps-toggles__container .erps-toggles__track {
      background: themes.color(orange, 70);
      border-color: themes.color(orange, 80);
      box-shadow:
        inset 0 1px 3px themes.color(black, 20),
        0 0 $toggle-shadow-blur themes.color(orange, 40);

      .erps-toggles__thumb {
        transform: translateY(-50%) translateX($toggle-thumb-travel);
        border-color: themes.color(orange, 80);
        box-shadow:
          $toggle-thumb-shadow themes.color(black, 40),
          0 0 $toggle-shadow-blur themes.color(orange, 50);
      }
    }
  }
}

// ===================================
// USAGE EXAMPLES (HTML)
// ===================================

/*
<!-- Basic toggle with label on left (default) -->
<label class="erps-toggles">
  <input type="checkbox" class="erps-toggles__input">
  <div class="erps-toggles__container">
    <span class="erps-toggles__label">Enable Feature</span>
    <span class="erps-toggles__track">
      <span class="erps-toggles__thumb"></span>
    </span>
  </div>
</label>

<!-- Small toggle without label -->
<label class="erps-toggles erps-toggles--small erps-toggles--no-label">
  <input type="checkbox" class="erps-toggles__input">
  <div class="erps-toggles__container">
    <span class="erps-toggles__track">
      <span class="erps-toggles__thumb"></span>
    </span>
  </div>
</label>

<!-- Toggle with label on right -->
<label class="erps-toggles erps-toggles--label-right">
  <input type="checkbox" class="erps-toggles__input">
  <div class="erps-toggles__container">
    <span class="erps-toggles__label">Auto-save</span>
    <span class="erps-toggles__track">
      <span class="erps-toggles__thumb"></span>
    </span>
  </div>
</label>

<!-- Toggle with label above -->
<label class="erps-toggles erps-toggles--label-above">
  <input type="checkbox" class="erps-toggles__input">
  <div class="erps-toggles__container">
    <span class="erps-toggles__label">Setting Name</span>
    <span class="erps-toggles__track">
      <span class="erps-toggles__thumb"></span>
    </span>
  </div>
</label>

<!-- Toggle with label below -->
<label class="erps-toggles erps-toggles--label-below">
  <input type="checkbox" class="erps-toggles__input">
  <div class="erps-toggles__container">
    <span class="erps-toggles__label">Option</span>
    <span class="erps-toggles__track">
      <span class="erps-toggles__thumb"></span>
    </span>
  </div>
</label>

<!-- Success-themed toggle -->
<label class="erps-toggles erps-toggles--success">
  <input type="checkbox" class="erps-toggles__input" checked>
  <div class="erps-toggles__container">
    <span class="erps-toggles__label">Task Complete</span>
    <span class="erps-toggles__track">
      <span class="erps-toggles__thumb"></span>
    </span>
  </div>
</label>
*/
