<section class="tab embedded-combat-powers {{tab.cssClass}}" data-group="primary" data-tab="embeddedCombatPowers">
  <div class="eventide-sheet__scrollable-container">
    <div class="erps-items-panel">
      <div class="erps-items-panel__section-header">
        {{localize "EVENTIDE_RP_SYSTEM.Item.Transformation.EmbeddedPowers"}}
      </div>

      {{#if embeddedCombatPowers.length}}
        <ol class="erps-items-panel__list erps-items-panel__list--three-column">
          <li class="erps-items-panel__item erps-items-panel__item--header">
            <div class="erps-items-panel__cell erps-items-panel__cell--image">{{localize 'Image'}}</div>
            <div class='erps-items-panel__cell erps-items-panel__cell--name'>{{localize 'Name'}}</div>
            <div class='erps-items-panel__cell erps-items-panel__cell--controls'>{{localize 'Controls'}}</div>
          </li>
          {{#each embeddedCombatPowers as |power|}}
            <li
              class="erps-items-panel__item erps-items-panel__item--draggable"
              data-item-id="{{power.id}}"
              data-drag="true"
              data-document-class="Item"
              title="{{localize 'EVENTIDE_RP_SYSTEM.Item.Transformation.DragToExtract'}}"
            >
              <div class="erps-items-panel__cell erps-items-panel__cell--image">
                <img
                  class="erps-items-panel__image"
                  src="{{power.img}}"
                  title="{{power.name}}"
                  width="24"
                  height="24"
                />
                <i class="fas fa-arrows-alt erps-items-panel__drag-indicator" title="{{localize 'EVENTIDE_RP_SYSTEM.Item.Transformation.DragToExtract'}}"></i>
              </div>
              <div class="erps-items-panel__cell erps-items-panel__cell--name">
                <span class="erps-items-panel__name">{{power.name}}</span>
              </div>
              <div class="erps-items-panel__cell erps-items-panel__cell--controls">
                <a
                  class="erps-items-panel__control erps-items-panel__control--edit"
                  data-action="editEmbeddedPower"
                  title="{{localize 'EVENTIDE_RP_SYSTEM.UI.Edit'}}"
                >
                  <i class="fas fa-edit"></i>
                </a>
                <a
                  class="erps-items-panel__control erps-items-panel__control--delete"
                  data-action="removeCombatPower"
                  data-power-id="{{power.id}}"
                  title="{{localize 'EVENTIDE_RP_SYSTEM.UI.Remove'}}"
                >
                  <i class="fas fa-trash"></i>
                </a>
              </div>
            </li>
          {{/each}}
        </ol>
      {{else}}
        <div class="erps-items-panel__empty">{{localize "EVENTIDE_RP_SYSTEM.Item.Transformation.NoPowers"}}</div>
      {{/if}}

      <div class="erps-items-panel__drop-zone" data-drop-zone="combatPower">
        <p>{{localize "EVENTIDE_RP_SYSTEM.Item.Transformation.DropPowerHere"}}</p>
      </div>

      {{!-- Action buttons section --}}
      <div class="erps-items-panel__actions">
        <div class="erps-form-actions">
          <button type="button" class="erps-button erps-button--secondary" data-action="createNewCombatPower" title="{{localize 'EVENTIDE_RP_SYSTEM.CreationButtons.CreateNew'}}">
            <i class="fas fa-plus"></i> {{localize "EVENTIDE_RP_SYSTEM.CreationButtons.CreateNewPower"}}
          </button>
        </div>

        {{!-- Search and add existing powers --}}
        <div class="erps-form-group">
          <label class="erps-form-label">{{localize "EVENTIDE_RP_SYSTEM.Forms.AddExisting"}}</label>
          <div class="erps-item-selector" data-selector="combat-powers"></div>
        </div>
      </div>

      <div class="erps-items-panel__notes">
        <p>{{localize "EVENTIDE_RP_SYSTEM.Item.Transformation.Notes"}}</p>
        <p><strong>{{localize "EVENTIDE_RP_SYSTEM.Item.Transformation.DragNote"}}</strong></p>
      </div>
    </div>
  </div>
</section>
